<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="robots" content="noindex">
    <title>スペクトラムアナライザー</title>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.11.1/dist/cdn.min.js"></script>
    <script src="spectrum-analyzer.js"></script>
    <style>
      .mycanvas {
        border:1px solid gray;
        border-radius:4px;
        margin:8px;
      }
    </style>
  </head>
  <body>
    <div x-data="initialData">
      <div>
        <div>
          横軸：<select x-model="renderMode">
            <template x-for="opt in RenderModeOptions" :key="opt.value">
              <option :value="opt.value" x-text="opt.text" :selected="renderMode==opt.value"></option>
            </template>
          </select>
        </div>

        <div style="display:flex; width:250px; justify-content:space-between;">
          <div>Max: </div>
          <div><span x-text="maxDecibels"></span>dB</div>
          <div><input x-model="maxDecibels" type="range" min="-100" max="0" step="1" /></div>
        </div>
        <div style="display:flex; width:250px; justify-content:space-between;">
          <div>Min: </div>
          <div><span x-text="minDecibels"></span>dB</div>
          <div><input x-model="minDecibels" type="range" min="-100" max="0" step="1" /></div>
        </div>

        <div>
          fftSize：<select x-model="fftSize">
            <template x-for="opt in FftSizeOptions" :key="opt">
              <option :value="opt" x-text="opt" :selected="fftSize==opt"></option>
            </template>
          </select>
        </div>

        <div>
          Smoothing: <span x-text="smoothing" style="display:inline-block; width:30px"></span><input x-model="smoothing" type="range" min="0" max="1.0" step="0.1" />
        </div>

        <div>
          <input id="song-file" type="file" @change="onFileChange(Object.values($event.target.files))" />
          <button @click="stop()" :disabled="!playing">Stop</button>
        </div>

        <div>
      		<audio id="player0" controls preload="auto" crossorigin="anonymous" style="width:600px"></audio>
        </div>
      </div>
    </div>

    <canvas id="mycanvas" class="mycanvas" width="800px" height="600"></canvas>
  </body>
</html>
